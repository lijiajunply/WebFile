@page "/"
@using Row = BootstrapBlazor.Components.Row

<PageTitle>@(IsAuthenticated ? $"{User.UserName} : 个人中心" : "主页")</PageTitle>

@if (IsAuthenticated)
{
    <h2>欢迎! @User.UserName</h2>
    <Divider/>
    <Row ItemsPerRow="ItemsPerRow.Four" ColSpan="4">
        @foreach (var item in FolderModels)
        {
            <a href="@ToUrl(item)">
                <ContextMenuZone>
                    <ContextMenuTrigger>
                        <Card IsShadow="true" class="item">
                            <BodyTemplate>
                                <FileIcon class="custom-icon" IconColor="@GetIconColor(item)" Extension="@Path.GetExtension(item.Path)"/>
                                <h6>@Path.GetFileNameWithoutExtension(item.Path)</h6>
                            </BodyTemplate>
                        </Card>
                    </ContextMenuTrigger>
                    <ContextMenu>
                        <ContextMenuItem Icon="fa-solid fa-file" Text="打开" OnClick="@((_, _) => { NavigationManager.NavigateTo($"/WebFileView/{item.Id}");return Task.CompletedTask;})"/>
                        <ContextMenuItem Icon="fa-solid fa-trash" Text="删除" OnClick="@(async (_, _) => await OnDelete(item))"/>
                        <ContextMenuItem Icon="fa-solid fa-cloud-arrow-down" Text="下载" OnClick="@(async (_, _) => await OnDownload(item))"/>
                    </ContextMenu>
                </ContextMenuZone>
            </a>
        }
    </Row>

    <SlideButton Icon="fa-solid fa-plus" Text="上传">
        <BodyTemplate>
            <ButtonUpload TValue="string" OnChange="@OnUploadFile"
                          ShowUploadFileList="false" BrowserButtonText="上传文件"
                          BrowserButtonIcon="fa-solid fa-cloud-arrow-up" BrowserButtonClass="SlideItem btn-primary">
            </ButtonUpload>
            <Button Icon="fa-solid fa-folder" Text="添加新文件夹" OnClick="@OnAddFolder" class="SlideItem"></Button>
        </BodyTemplate>
    </SlideButton>
}
else
{
    <h1>WebFile</h1>
    <p>WebFile是一个云文件管理储存系统，您只要注册、登录账号即可</p>
    <NavLink class="nav-link" href="/Account/Login" Match="NavLinkMatch.All">
        <span class="fa-solid fa-house" aria-hidden="true"></span> Home
    </NavLink>
}

<style>
    .item{
        height: 200px;
        width: 200px;
    }
    .SlideItem{
        width: 100%;
        margin-bottom: 1px;
    }
</style>